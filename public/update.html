<!-- 
Name: Kunal Chopra
Date: 6/5/2023
Course: CS290
-->
<!DOCTYPE html>
<html>
<head>
  <title>Update Song</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
    <header>
        <h1>Music Services</h1>
        <nav>
           <a href="index.html">Home</a>
           <a href="search.html">Search by genre</a>
           <a href="update.html">Update a song</a>
           <a href="delete.html">Delete a song</a>
           <a href="add.html">Add a song</a>
           <a href="list.html">List all songs</a>
        </nav>
     </header>

  <h2>All Songs</h2>
  <table id="songTable">
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>Artist</th>
      <th>Genre</th>
      <th>Released</th>
      <th>Popularity</th>
      <th>Select</th>
    </tr>
  </table>

  <h2>Update Song Details</h2>
  <form id="updateForm" action="/update" method="POST">
    <label for="title">Title:</label>
    <input type="text" id="title" name="title">

    <label for="artist">Artist:</label>
    <input type="text" id="artist" name="artist">

    <label for="genre">Genre:</label>
    <input type="text" id="genre" name="genre">

    <label for="released">Released:</label>
    <input type="text" id="released" name="released">

    <label for="popularity">Popularity:</label>
    <input type="text" id="popularity" name="popularity">

    <button type="submit">Update</button>
  </form>
  
  <footer>
    <p>&copy; 2023 Kunal Chopra Music Company</p>
 </footer> 

 <script>
  // Fetch all songs from the server and populate the table
  fetch('/allSongs')
    .then(function(response) {
      return response.json();
    })
    .then(function(songs) {
      var table = document.getElementById('songTable');
      songs.forEach(function(song) {
        var row = table.insertRow();
        row.insertCell().textContent = song._id;
        row.insertCell().textContent = song.title;
        row.insertCell().textContent = song.artist;
        row.insertCell().textContent = song.genre;
        row.insertCell().textContent = song.releaseDate;
        row.insertCell().textContent = song.popularity;
        var selectCell = row.insertCell();
        var selectButton = document.createElement('button');
        selectButton.textContent = 'Select';
        selectButton.addEventListener('click', function() {
          // Set the form values based on the selected song
          document.getElementById('title').value = song.title;
          document.getElementById('artist').value = song.artist;
          document.getElementById('genre').value = song.genre;
          document.getElementById('released').value = song.releaseDate;
          document.getElementById('popularity').value = song.popularity;
        });
        selectCell.appendChild(selectButton);
      });
    });
</script>
</body>
</html>
